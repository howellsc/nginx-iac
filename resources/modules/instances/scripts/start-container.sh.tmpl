#!/bin/bash

# A name for the container and image
CONTAINER_NAME="${container_name}"
IMAGE="${image}"

mkdir /home/appuser
# Set home directory to save docker credentials
export HOME=/home/appuser

cd ~

# Configure docker with credentials for gcr.io and pkg.dev
docker-credential-gcr configure-docker

# Stop and remove the container if it exists
docker stop $CONTAINER_NAME || true
docker rm $CONTAINER_NAME || true

# Pull the latest version of the container image
docker pull $IMAGE

# Run docker container
docker run --name $CONTAINER_NAME $IMAGE
